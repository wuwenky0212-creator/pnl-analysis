# 🌐 公网公开部署方案 - 让所有人都能访问

## 📋 部署方案对比

| 方案 | 前端 | 后端 | 费用 | 难度 | 推荐度 |
|------|------|------|------|------|--------|
| **Railway** | ✅ | ✅ | 免费额度$5/月 | ⭐⭐ | ⭐⭐⭐⭐⭐ |
| **Render** | ✅ | ✅ | 免费（有限制） | ⭐⭐ | ⭐⭐⭐⭐ |
| **Fly.io** | ✅ | ✅ | 免费额度 | ⭐⭐⭐ | ⭐⭐⭐⭐ |
| **Vercel + Railway** | ✅ | ✅ | 免费 | ⭐⭐ | ⭐⭐⭐⭐⭐ |
| **Netlify + Railway** | ✅ | ✅ | 免费 | ⭐⭐ | ⭐⭐⭐⭐ |
| **DigitalOcean** | ✅ | ✅ | $4/月起 | ⭐⭐⭐ | ⭐⭐⭐ |
| **Vultr** | ✅ | ✅ | $2.5/月起 | ⭐⭐⭐ | ⭐⭐⭐ |

---

## 🚀 方案一：Railway（推荐 - 最简单）

**优点**：前后端都能部署，一键部署，免费额度充足

### 步骤1：注册Railway账号
1. 访问：https://railway.app
2. 使用GitHub账号登录（推荐）

### 步骤2：部署后端
1. 在Railway控制台点击 "New Project"
2. 选择 "Deploy from GitHub repo"
3. 选择你的项目仓库
4. Railway会自动检测到Dockerfile
5. 配置环境变量：
   ```
   PORT=8002
   HOST=0.0.0.0
   DEBUG=False
   ```
6. 部署完成后，Railway会提供一个公网URL，例如：`https://your-app.railway.app`

### 步骤3：部署前端
1. 在Railway中创建新服务
2. 选择 "Deploy Static Files"
3. 选择 `frontend` 目录
4. 或者使用Railway的Nginx配置

### 步骤4：配置前端API地址
修改 `frontend/js/api.js`，使用Railway提供的后端URL。

---

## 🚀 方案二：Vercel（前端）+ Railway（后端）

**优点**：Vercel免费且快速，Railway部署后端

### 部署后端（Railway）
同方案一步骤2

### 部署前端（Vercel）
1. 访问：https://vercel.com
2. 使用GitHub账号登录
3. 点击 "Add New Project"
4. 导入你的GitHub仓库
5. 配置：
   - Framework Preset: Other
   - Root Directory: `frontend`
   - Build Command: （留空，因为是静态文件）
   - Output Directory: `.`
6. 添加环境变量（在Vercel项目设置中）：
   ```
   VITE_API_URL=https://your-backend.railway.app/api
   ```
7. 修改前端代码使用环境变量（见下方代码）

---

## 🚀 方案三：Render（全栈）

**优点**：前后端都能部署，免费套餐可用

### 部署步骤
1. 访问：https://render.com
2. 使用GitHub账号登录
3. 创建新Web Service（后端）
4. 创建新Static Site（前端）

---

## 🚀 方案四：Fly.io（推荐）

**优点**：全球CDN，免费额度充足

### 部署步骤
1. 访问：https://fly.io
2. 注册账号
3. 安装Fly CLI：`curl -L https://fly.io/install.sh | sh`
4. 登录：`fly auth login`
5. 部署后端：`fly launch`（在项目根目录）

---

## 📝 推荐的完整部署方案

### 方案A：Railway（最简单）

我已经为你准备了Railway部署配置。

### 方案B：Vercel + Railway（性能最好）

前端用Vercel（全球CDN），后端用Railway。

---

## 🔧 代码修改（适配公网部署）

### 1. 创建环境变量配置文件

创建 `frontend/.env.production`：
```env
VITE_API_URL=https://your-backend.railway.app/api
```

### 2. 修改前端API配置

修改 `frontend/js/api.js` 使用环境变量。

---

## 📦 我为你准备的部署文件

我已经创建了以下文件：
1. `railway.json` - Railway部署配置
2. `vercel.json` - Vercel部署配置
3. `render.yaml` - Render部署配置
4. 修改了前端API配置，支持环境变量

---

## 🎯 快速开始（推荐Railway）

### 1. 准备GitHub仓库
```bash
# 初始化Git仓库
git init
git add .
git commit -m "Initial commit"

# 推送到GitHub
git remote add origin https://github.com/你的用户名/损益归因分析.git
git push -u origin main
```

### 2. 部署到Railway
1. 访问 https://railway.app
2. 登录并创建新项目
3. 选择 "Deploy from GitHub repo"
4. 选择你的仓库
5. Railway会自动部署！

### 3. 获取访问链接
部署完成后，Railway会提供公网访问链接，任何人都可以访问！

---

## 💡 其他免费平台推荐

1. **Render**：https://render.com（免费套餐可用）
2. **Fly.io**：https://fly.io（每月免费额度）
3. **Netlify**：https://netlify.com（前端免费）
4. **Cloudflare Pages**：https://pages.cloudflare.com（前端免费）

---

## ⚠️ 注意事项

1. **免费额度限制**：
   - 大部分平台有免费额度限制
   - 超出后可能需要付费
   - Railway免费额度：$5/月

2. **数据持久化**：
   - 免费平台通常不提供持久化存储
   - 如果需要数据库，建议使用免费数据库服务（如Supabase、PlanetScale）

3. **域名绑定**：
   - 大部分平台支持自定义域名
   - 免费SSL证书自动配置

---

## 🎉 推荐顺序

1. **首选**：Railway（全栈部署，最简单）
2. **次选**：Vercel + Railway（前端更快）
3. **备选**：Render（全栈，免费套餐）


